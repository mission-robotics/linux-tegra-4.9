
#include <t18x-common-platforms/tegra186-quill-common-p3489-1000-a00.dtsi>
//#include <t18x-common-platforms/tegra186-quill-power-tree-p3489-1000-a00-00.dtsi>
#include <t18x-common-platforms/tegra186-tx2i-cti-power-tree.dtsi>
//#include <t18x-common-platforms/tegra186-quill-camera-modules.dtsi>
#include <t18x-common-modules/tegra186-display-e3320-1000-a00.dtsi>

/* comms dtsi file should be included after gpio dtsi file */
//#include <t18x-common-plugin-manager/tegra186-quill-p3489-1000-a00-plugin-manager.dtsi>
#include <t18x-common-plugin-manager/tegra186-tx2i-cti-plugin-manager.dtsi>
//#include <t18x-common-modules/tegra186-super-module-e2614-p2597-1000-a00.dtsi>
#include <t18x-common-plugin-manager/tegra186-quill-display-plugin-manager.dtsi>
#include <t18x-common-prod/tegra186-priv-quill-p3489-1000-a00-prod.dtsi>
//#include <t18x-common-plugin-manager/tegra186-quill-camera-plugin-manager.dtsi>
#include "cti_common/tegra186-tx2-cti-usb-pcie-base.dtsi"

/ {
	model = "storm";
	compatible = "nvidia,storm", "nvidia,p2597-0000+p3489-0000", "nvidia,tegra186";
	use_case_model = "ucm1";
    nvidia,dtsfilename = __FILE__;
    nvidia,dtbbuildtime = __DATE__, __TIME__;

	nvidia,boardids = "3489:0000:A0";
	nvidia,proc-boardid = "3489:0000:A0";
	nvidia,fastboot-usb-vid = <0x0955>;
	nvidia,fastboot-usb-pid = <0xee16>;

	chosen {
		board-has-eeprom;
		bootargs ="console=ttyS0,115200 androidboot.presilicon=true firmware_class.path=/etc/firmware";
		stdout-path = &uarta;
		nvidia,tegra-joint_xpu_rail;
	};

	firmware {
		android {
			compatible = "android,firmware";
			hardware = "quill";
		};
	};

	memory@80000000 {
		device_type = "memory";
		reg = <0x0 0x80000000 0x0 0x70000000>;
	};
	
    i2c@3160000 {
        gpio@74{
            status = "disabled";
            /delete-node/ touch-rails;
        };

        gpio@77{
            status = "disabled";
            /delete-node/ lcd-bias-rails;
        };

		lp8557-backlight-s-wuxga-8-0@2c {
			status = "disabled";
		};
	};

	i2c@c240000 {
		clock-frequency = <400000>;
	};

	cpus {
		status = "disabled";
	};

   pwm_fan_shared_data: pfsd
   {
        tach_gpio = <&tegra_main_gpio TEGRA_MAIN_GPIO(X, 4) GPIO_ACTIVE_LOW>;
   };

	host1x {
		disp_imp_table {
			num_settings = <7>;

			disp_imp_settings_6 {
				/* Calculated with 4 wins on one 1080p head */

				/* Global settings */
				nvidia,total_disp_bw_with_catchup = <0 2787800>;
				nvidia,total_disp_bw_without_catchup = <0 2534400>;
				nvidia,disp_emc_floor = <0 102000000>;
				nvidia,disp_min_hubclk = <0 49070000>;
				nvidia,total_win_fetch_slots = /bits/ 16 <1>;
				nvidia,total_cursor_fetch_slots = /bits/ 16 <1>;

				/* Window settings */
				nvidia,imp_win_mapping = /bits/ 8 <0 1 2 3 4 5>;
				nvidia,win_fetch_meter_slots = /bits/ 16 <1 1 1 1 1 1>;
				nvidia,win_dvfs_watermark_values = <0 0 0 0 0 0 0 0 0 0 0 0>;
				nvidia,win_pipe_meter_values = <0 0 0 0 0 0>;
				nvidia,win_mempool_buffer_entries = <0 817 0 817 0 817 0 817 0 817 0 817>;
				nvidia,win_thread_groups = /bits/ 8 <0 1 2 3 4 5>;

				/* Cursor settings */
				nvidia,imp_head_mapping = /bits/ 8 <0 1 2>;
				nvidia,cursor_fetch_meter_slots = /bits/ 16 <1 1 1>;
				nvidia,cursor_dvfs_watermark_values = <0 0 0 0 0 0>;
				nvidia,cursor_pipe_meter_values = <0 0 0>;
				nvidia,cursor_mempool_buffer_entries = <0 16 0 16 0 16>;
			};
		};

		sor {
			status = "disabled";
			dp-display {
				status = "disabled";
			};
			hdmi-display {
				status = "disabled";
			};

			panel-s-edp-uhdtv-15-6 {
				smartdimmer {
					status = "disabled";
				};
			};
		};

		dpaux@155c0000 {
			status = "disabled";
		};

		sor1 {
			status = "okay";
			hdmi-display {
				status = "okay";
			};
			dp-display {
				status = "disabled";
			};
		};

		nvdisplay@15200000 {
			status = "disabled";
		};

		nvdisplay@15220000 {
			status = "disabled";
		};
	};

        mttcan@c310000 {
                status = "disabled";
                gpio_can_stb = <&tegra_aon_gpio TEGRA_AON_GPIO(AA, 0) GPIO_ACTIVE_HIGH>;
                gpio_can_en = <&tegra_aon_gpio TEGRA_AON_GPIO(AA, 1) GPIO_ACTIVE_HIGH>;
        };

        mttcan@c320000 {
                status = "disabled";
                gpio_can_stb = <&tegra_aon_gpio TEGRA_AON_GPIO(AA, 6) GPIO_ACTIVE_HIGH>;
                gpio_can_en = <&tegra_aon_gpio TEGRA_AON_GPIO(AA, 7) GPIO_ACTIVE_HIGH>;
        };

        mc {
               ecc_on_camera_fw;
        };

	rtcpu@b000000 {
		/delete-property/ autosuspend-delay-ms;
		nvidia,disable-runtime-pm;
	};
	bpmp_i2c {
		spmic@3c {
			regulators {
				ldo0 {
					maxim,active-fps-source = <MAX77620_FPS_SRC_NONE>;
				};
				ldo6 {
					maxim,active-fps-source = <MAX77620_FPS_SRC_NONE>;
					regulator-boot-on;
					regulator-always-on;
				};
				ldo7 {
					regulator-min-microvolt = <1000000>;
					regulator-max-microvolt = <1000000>;
				};
				ldo8 {
					regulator-name = "dvdd-pex";
					regulator-min-microvolt = <1000000>;
					regulator-max-microvolt = <1000000>;
				};
			};
			pinmux@0 {
				pin_gpio2 {
					status = "disabled";
				};
				pin_gpio3 {
					status = "disabled";
				};
				pin_gpio7 {
					drive-push-pull = <1>;
				};
			};
		};
	};
	
    ahci-sata@3507000 {
		gpios = <&spmic 7 0>;
	};

	gpio@2200000 {
		sdmmc-wake-support-input {
		        status = "okay";
		};
		sdmmc-wake-support-output {
		        status = "okay";
		};
	};

	fixed-regulators {
		regulator@1 {
			gpio = <&tegra_main_gpio TEGRA_MAIN_GPIO(P, 6) 0>;
		};
        regulator@2 {
            regulator-always-on;
            /delete-property/ gpio;
            /delete-property/ enable-active-high;
        };
        regulator@3 {
            regulator-always-on;
            /delete-property/ gpio;
        };
        regulator@6 {
            regulator-always-on;
            /delete-property/ gpio;
        };
        regulator@7 {
            regulator-always-on;
            /delete-property/ gpio;
        };
        regulator@8 {
            regulator-always-on;
            /delete-property/ gpio;
        };
        regulator@9 {
            regulator-always-on;
            /delete-property/ gpio;
        };
        regulator@10 {
            regulator-always-on;
            /delete-property/ gpio;
        };
        regulator@11 {
            regulator-always-on;
            /delete-property/ gpio;
        };
        regulator@12 {
            regulator-always-on;
            /delete-property/ gpio;
        };
        regulator@13 { //fixes PWM fan
            regulator-always-on;
            /delete-property/ gpio;
        };
        regulator@15 {
            regulator-always-on;
            /delete-property/ gpio;
        };
        regulator@17 {
            regulator-always-on;
            /delete-property/ gpio;
        };
        regulator@118 {
            regulator-always-on;
            /delete-property/ gpio;
        };
	};

	sdhci@3400000 {
		cd-gpios = <&tegra_main_gpio TEGRA_MAIN_GPIO(P, 5) 0>;
		nvidia,cd-wakeup-capable;
	};

	ina3221x@40 {
		channel@0 {
		        ti,shunt-resistor-mohm = <10>;
		};
		channel@1 {
		        ti,shunt-resistor-mohm = <10>;
		};
	};

	ina3221x@41 {
		 channel@0 {
			ti,shunt-resistor-mohm = <20>;
		 };
		 channel@1 {
			ti,shunt-resistor-mohm = <10>;
		 };
		 channel@2 {
			ti,rail-name = "VDD_SYS_DDR";
			ti,shunt-resistor-mohm = <10>;
		 };
	};

	tegra_udrm: tegra_udrm {
		compatible = "nvidia,tegra-udrm";
	};
	
	soctherm-oc-event {
		status = "okay";
	};

    can_clock: can_clock{
        compatible = "fixed-clock";
        #clock-cells = <0>;
        clock-frequency = <20000000>;
        clock-accuracy = <100>;
    };

};

#ifdef KERNEL_VERSION_4_9
#include "quill-platforms/tegra186-quill-kernel-4.9.dtsi"
#endif
